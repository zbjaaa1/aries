# Maintainer: Caleb Connolly <caleb@postmarketos.org>
# Co-Maintainer: Ferass El Hafidi <funderscore@postmarketos.org>
# Reference: <https://postmarketos.org/devicepkg>
pkgname=device-postmarketos-trailblazer
pkgdesc="postmarketOS Trailblazer generic ARM64"
pkgver=12
pkgrel=1
url="https://postmarketos.org"
license="MIT"
arch="aarch64"
options="!check !archcheck"
depends="
	postmarketos-base
	soc-qcom-qbootctl
	linux-firmware-qcom
	linux-firmware-ath10k
	linux-firmware-ath11k
	linux-firmware-ath12k
	linux-firmware-qca
	linux-firmware-rtw88
	linux-firmware-rtl_nic
	rmtfs
	pd-mapper
	tqftpserv
	bootmac
	systemd-boot
	firmware-siliconlabs-rs9116
	firmware-brcm43752
	dtbloader
	woa-firmware-yoinker
"
makedepends="devicepkg-dev"
subpackages="
	$pkgname-kernel-next:kernel_next
	$pkgname-kernel-lts:kernel_lts
	$pkgname-kernel-edge:kernel_edge
	$pkgname-kernel-postmarketos-qcom-laptop:kernel_postmarketos_qcom_laptop
	$pkgname-kernel-postmarketos-amlogic:kernel_postmarketos_amlogic
"
source="
	deviceinfo
	modules-initfs
	initfs-hook.sh
"

build() {
	devicepkg_build $startdir $pkgname
}

package() {
	devicepkg_package $startdir $pkgname
}

kernel_next() {
	pkgdesc="Unstable next kernel (linux-next)"
	depends="linux-next"
	devicepkg_subpackage_kernel $startdir $pkgname $subpkgname
}

kernel_lts() {
	pkgdesc="Long term support (LTS) kernel from Alpine Linux (linux-lts)"
	depends="linux-lts"
	devicepkg_subpackage_kernel $startdir $pkgname $subpkgname
}

kernel_edge() {
	pkgdesc="Mainline kernel from Alpine Linux (linux-edge)"
	depends="linux-edge"
	devicepkg_subpackage_kernel $startdir $pkgname $subpkgname
}

kernel_postmarketos_qcom_laptop() {
	pkgdesc="Mainline kernel with additional patches for Qualcomm Snapdragon-based laptops (linux-postmarketos-qcom-laptop)"
	depends="linux-postmarketos-qcom-laptop"
	devicepkg_subpackage_kernel $startdir $pkgname $subpkgname
}

kernel_postmarketos_amlogic() {
	pkgdesc="Mainline kernel with additional patches for Amlogic AArch64-based devices (linux-postmarketos-amlogic)"
	depends="linux-postmarketos-amlogic"
	devicepkg_subpackage_kernel $startdir $pkgname $subpkgname
}

sha512sums="
12e7c1af63b24a37198a73e77d45cc5cbcb3ce34bbdb32d913cb3e427896ddcf2266269f8fe0c73c15c751a34ad738bd7fc958629ad066cd3c0a9faaaae7d67f  deviceinfo
2c22b6a385c4094f6850728cf36d74ade0aa97adf16a4aee6662b9fd4bbb2ea0372e4869960e329d53cd0c84727163bd160e2c66f1eadd637ae3277d14141b29  modules-initfs
05e8d72b1ee1c61aea7663c497d9f103c460a7f285aa28a2274101bd63ea9e1ed27c54c2855752647867b586dd8674b56fa54161d3ebe53e59f7041c938bc34f  initfs-hook.sh
"
